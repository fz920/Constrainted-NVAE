2022-08-21 11:35:49,659 (Elapsed: 00:00:04) args = Namespace(ada_groups=False, arch_instance='res_mbconv', batch_size=64, cont_training=False, data='/data/users/fz920/data/cifar10', dataset='cifar10', distributed=True, epochs=12, fast_adamax=True, global_rank=0, kl_anneal_portion=0.3, kl_const_coeff=0.0001, kl_const_portion=0.0001, learning_rate=0.005, learning_rate_min=0.0001, local_rank=0, master_address='127.0.0.1', min_groups_per_scale=1, node_rank=0, num_cell_per_cond_dec=2, num_cell_per_cond_enc=2, num_channels_dec=32, num_channels_enc=32, num_groups_per_scale=10, num_latent_per_group=20, num_latent_scales=1, num_mixture_dec=10, num_nf=0, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=2, num_proc_node=1, num_process_per_node=1, num_total_iter=9372, num_x_bits=8, res_dist=True, root='/data/users/fz920/Constrainted-NVAE/checkpoint', save='/data/users/fz920/Constrainted-NVAE/checkpoint/eval-20', seed=1, use_se=True, warmup_epochs=5, weight_decay=0.0003, weight_decay_norm=0.05, weight_decay_norm_anneal=False, weight_decay_norm_init=10.0)
2022-08-21 11:35:49,669 (Elapsed: 00:00:04) param size = 3.108576M 
2022-08-21 11:35:49,669 (Elapsed: 00:00:04) groups per scale: [10], total_groups: 10
2022-08-21 11:35:49,672 (Elapsed: 00:00:04) epoch 0
2022-08-21 11:36:20,442 (Elapsed: 00:00:35) train 99 18601.365234
2022-08-21 11:36:51,031 (Elapsed: 00:01:06) train 199 16478.171875
2022-08-21 11:37:20,743 (Elapsed: 00:01:36) train 299 15182.867188
2022-08-21 11:37:51,202 (Elapsed: 00:02:06) train 399 14376.140625
2022-08-21 11:38:22,876 (Elapsed: 00:02:38) train 499 13775.573242
2022-08-21 11:38:53,725 (Elapsed: 00:03:08) train 599 13332.130859
2022-08-21 11:39:23,820 (Elapsed: 00:03:39) train 699 13001.568359
2022-08-21 11:39:50,755 (Elapsed: 00:04:06) train_nelbo 12771.675781
2022-08-21 11:41:32,194 (Elapsed: 00:05:47) val, step: 156, NELBO: 111187.273438, neg Log p 110897.304688
2022-08-21 11:41:32,195 (Elapsed: 00:05:47) valid_nelbo 111187.273438
2022-08-21 11:41:32,196 (Elapsed: 00:05:47) valid neg log p 110897.304688
2022-08-21 11:41:32,196 (Elapsed: 00:05:47) valid bpd elbo 52.216579
2022-08-21 11:41:32,196 (Elapsed: 00:05:47) valid bpd log p 52.080402
2022-08-21 11:41:32,197 (Elapsed: 00:05:47) KL distance 10187.992188
2022-08-21 11:41:32,199 (Elapsed: 00:05:47) saving the model.
2022-08-21 11:41:32,324 (Elapsed: 00:05:47) epoch 1
2022-08-21 11:41:39,308 (Elapsed: 00:05:54) train 799 10477.205078
2022-08-21 11:42:13,671 (Elapsed: 00:06:28) train 899 10461.050781
2022-08-21 11:42:45,646 (Elapsed: 00:07:00) train 999 10428.062500
2022-08-21 11:43:17,267 (Elapsed: 00:07:32) train 1099 10329.239258
2022-08-21 11:43:50,155 (Elapsed: 00:08:05) train 1199 10246.459961
2022-08-21 11:44:22,254 (Elapsed: 00:08:37) train 1299 10153.803711
2022-08-21 11:44:53,753 (Elapsed: 00:09:09) train 1399 10088.140625
2022-08-21 11:45:25,076 (Elapsed: 00:09:40) train 1499 10012.617188
2022-08-21 11:45:45,073 (Elapsed: 00:10:00) train_nelbo 9965.906250
2022-08-21 11:47:26,350 (Elapsed: 00:11:41) val, step: 156, NELBO: 135921.921875, neg Log p 135599.031250
2022-08-21 11:47:26,351 (Elapsed: 00:11:41) valid_nelbo 135921.921875
2022-08-21 11:47:26,351 (Elapsed: 00:11:41) valid neg log p 135599.031250
2022-08-21 11:47:26,351 (Elapsed: 00:11:41) valid bpd elbo 63.832645
2022-08-21 11:47:26,351 (Elapsed: 00:11:41) valid bpd log p 63.681007
2022-08-21 11:47:26,351 (Elapsed: 00:11:41) KL distance 12719.914062
2022-08-21 11:47:26,353 (Elapsed: 00:11:41) saving the model.
2022-08-21 11:47:26,829 (Elapsed: 00:11:42) epoch 2
2022-08-21 11:47:39,570 (Elapsed: 00:11:54) train 1599 9415.670898
2022-08-21 11:48:11,944 (Elapsed: 00:12:27) train 1699 9338.114258
2022-08-21 11:48:46,028 (Elapsed: 00:13:01) train 1799 9207.952148
2022-08-21 11:49:19,169 (Elapsed: 00:13:34) train 1899 9097.846680
2022-08-21 11:49:50,997 (Elapsed: 00:14:06) train 1999 8977.516602
2022-08-21 11:50:23,376 (Elapsed: 00:14:38) train 2099 8895.428711
2022-08-21 11:50:55,687 (Elapsed: 00:15:10) train 2199 8822.393555
2022-08-21 11:51:28,928 (Elapsed: 00:15:44) train 2299 8773.955078
2022-08-21 11:51:42,726 (Elapsed: 00:15:57) train_nelbo 8750.074219
2022-08-21 11:53:24,079 (Elapsed: 00:17:39) val, step: 156, NELBO: 137177.218750, neg Log p 136899.421875
2022-08-21 11:53:24,079 (Elapsed: 00:17:39) valid_nelbo 137177.218750
2022-08-21 11:53:24,079 (Elapsed: 00:17:39) valid neg log p 136899.421875
2022-08-21 11:53:24,080 (Elapsed: 00:17:39) valid bpd elbo 64.422165
2022-08-21 11:53:24,080 (Elapsed: 00:17:39) valid bpd log p 64.291702
2022-08-21 11:53:24,080 (Elapsed: 00:17:39) KL distance 12868.337891
2022-08-21 11:53:24,081 (Elapsed: 00:17:39) saving the model.
2022-08-21 11:53:24,653 (Elapsed: 00:17:39) epoch 3
2022-08-21 11:53:43,439 (Elapsed: 00:17:58) train 2399 8046.008301
2022-08-21 11:54:14,917 (Elapsed: 00:18:30) train 2499 8031.383789
2022-08-21 11:54:48,079 (Elapsed: 00:19:03) train 2599 7980.884766
2022-08-21 11:55:20,720 (Elapsed: 00:19:35) train 2699 7939.509277
2022-08-21 11:55:52,565 (Elapsed: 00:20:07) train 2799 7890.841797
2022-08-21 11:56:25,207 (Elapsed: 00:20:40) train 2899 7790.671875
2022-08-21 11:56:57,259 (Elapsed: 00:21:12) train 2999 7753.607910
2022-08-21 11:57:29,390 (Elapsed: 00:21:44) train 3099 7696.135742
2022-08-21 11:57:37,173 (Elapsed: 00:21:52) train_nelbo 7675.534668
2022-08-21 11:59:18,210 (Elapsed: 00:23:33) val, step: 156, NELBO: 148540.406250, neg Log p 148256.828125
2022-08-21 11:59:18,211 (Elapsed: 00:23:33) valid_nelbo 148540.406250
2022-08-21 11:59:18,211 (Elapsed: 00:23:33) valid neg log p 148256.828125
2022-08-21 11:59:18,211 (Elapsed: 00:23:33) valid bpd elbo 69.758629
2022-08-21 11:59:18,211 (Elapsed: 00:23:33) valid bpd log p 69.625450
2022-08-21 11:59:18,211 (Elapsed: 00:23:33) KL distance 14052.437500
2022-08-21 11:59:18,213 (Elapsed: 00:23:33) saving the model.
2022-08-21 11:59:18,721 (Elapsed: 00:23:33) epoch 4
2022-08-21 11:59:43,412 (Elapsed: 00:23:58) train 3199 7423.735352
2022-08-21 12:00:14,605 (Elapsed: 00:24:29) train 3299 7260.074219
2022-08-21 12:00:45,489 (Elapsed: 00:25:00) train 3399 7170.673828
2022-08-21 12:01:16,756 (Elapsed: 00:25:32) train 3499 7158.299805
2022-08-21 12:01:48,181 (Elapsed: 00:26:03) train 3599 7096.099121
2022-08-21 12:02:19,613 (Elapsed: 00:26:34) train 3699 7019.925293
2022-08-21 12:02:51,202 (Elapsed: 00:27:06) train 3799 6936.521484
2022-08-21 12:03:22,526 (Elapsed: 00:27:37) train 3899 6870.745117
2022-08-21 12:03:24,231 (Elapsed: 00:27:39) train_nelbo 6866.358398
2022-08-21 12:05:05,904 (Elapsed: 00:29:21) val, step: 156, NELBO: 148694.109375, neg Log p 148425.046875
2022-08-21 12:05:05,904 (Elapsed: 00:29:21) valid_nelbo 148694.109375
2022-08-21 12:05:05,905 (Elapsed: 00:29:21) valid neg log p 148425.046875
2022-08-21 12:05:05,905 (Elapsed: 00:29:21) valid bpd elbo 69.830811
2022-08-21 12:05:05,905 (Elapsed: 00:29:21) valid bpd log p 69.704453
2022-08-21 12:05:05,905 (Elapsed: 00:29:21) KL distance 14088.887695
2022-08-21 12:05:05,907 (Elapsed: 00:29:21) saving the model.
2022-08-21 12:05:06,377 (Elapsed: 00:29:21) epoch 5
2022-08-21 12:05:36,849 (Elapsed: 00:29:52) train 3999 6511.391113
2022-08-21 12:06:08,078 (Elapsed: 00:30:23) train 4099 6298.699707
2022-08-21 12:06:39,139 (Elapsed: 00:30:54) train 4199 6260.344727
2022-08-21 12:07:10,429 (Elapsed: 00:31:25) train 4299 6175.111328
2022-08-21 12:07:41,464 (Elapsed: 00:31:56) train 4399 6092.311035
2022-08-21 12:08:12,474 (Elapsed: 00:32:27) train 4499 6045.936523
2022-08-21 12:08:43,797 (Elapsed: 00:32:59) train 4599 6029.647949
2022-08-21 12:09:10,551 (Elapsed: 00:33:25) train_nelbo 5984.983887
2022-08-21 12:10:51,677 (Elapsed: 00:35:06) val, step: 156, NELBO: 153781.359375, neg Log p 153516.109375
2022-08-21 12:10:51,678 (Elapsed: 00:35:06) valid_nelbo 153781.359375
2022-08-21 12:10:51,678 (Elapsed: 00:35:06) valid neg log p 153516.109375
2022-08-21 12:10:51,678 (Elapsed: 00:35:06) valid bpd elbo 72.219925
2022-08-21 12:10:51,678 (Elapsed: 00:35:06) valid bpd log p 72.095352
2022-08-21 12:10:51,679 (Elapsed: 00:35:06) KL distance 14650.291016
2022-08-21 12:10:51,681 (Elapsed: 00:35:06) saving the model.
2022-08-21 12:10:52,182 (Elapsed: 00:35:07) epoch 6
2022-08-21 12:10:57,252 (Elapsed: 00:35:12) train 4699 5671.008301
2022-08-21 12:11:28,577 (Elapsed: 00:35:43) train 4799 5553.651367
2022-08-21 12:11:59,925 (Elapsed: 00:36:15) train 4899 5593.961914
2022-08-21 12:12:31,850 (Elapsed: 00:36:47) train 4999 5512.254395
2022-08-21 12:13:02,739 (Elapsed: 00:37:18) train 5099 5473.222656
2022-08-21 12:13:34,364 (Elapsed: 00:37:49) train 5199 5493.289551
2022-08-21 12:14:06,421 (Elapsed: 00:38:21) train 5299 5472.799316
2022-08-21 12:14:37,744 (Elapsed: 00:38:53) train 5399 5422.238770
2022-08-21 12:14:58,863 (Elapsed: 00:39:14) train_nelbo 5406.096191
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) val, step: 156, NELBO: 162425.593750, neg Log p 162153.812500
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) valid_nelbo 162425.593750
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) valid neg log p 162153.812500
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) valid bpd elbo 76.279495
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) valid bpd log p 76.151855
2022-08-21 12:16:40,566 (Elapsed: 00:40:55) KL distance 15439.862305
2022-08-21 12:16:40,568 (Elapsed: 00:40:55) saving the model.
2022-08-21 12:16:41,037 (Elapsed: 00:40:56) epoch 7
2022-08-21 12:16:52,608 (Elapsed: 00:41:07) train 5499 4781.802246
2022-08-21 12:17:24,475 (Elapsed: 00:41:39) train 5599 4837.396973
2022-08-21 12:17:55,530 (Elapsed: 00:42:10) train 5699 4759.974121
2022-08-21 12:18:26,732 (Elapsed: 00:42:42) train 5799 4717.756836
2022-08-21 12:18:57,764 (Elapsed: 00:43:13) train 5899 4690.330078
2022-08-21 12:19:28,756 (Elapsed: 00:43:44) train 5999 4678.158203
2022-08-21 12:19:59,890 (Elapsed: 00:44:15) train 6099 4640.151855
2022-08-21 12:20:30,885 (Elapsed: 00:44:46) train 6199 4618.772949
2022-08-21 12:20:45,864 (Elapsed: 00:45:01) train_nelbo 4625.137207
2022-08-21 12:22:27,559 (Elapsed: 00:46:42) val, step: 156, NELBO: 161683.546875, neg Log p 161423.828125
2022-08-21 12:22:27,560 (Elapsed: 00:46:42) valid_nelbo 161683.546875
2022-08-21 12:22:27,560 (Elapsed: 00:46:42) valid neg log p 161423.828125
2022-08-21 12:22:27,560 (Elapsed: 00:46:42) valid bpd elbo 75.931007
2022-08-21 12:22:27,560 (Elapsed: 00:46:42) valid bpd log p 75.809036
2022-08-21 12:22:27,560 (Elapsed: 00:46:42) KL distance 15510.837891
2022-08-21 12:22:27,562 (Elapsed: 00:46:42) saving the model.
2022-08-21 12:22:28,062 (Elapsed: 00:46:43) epoch 8
2022-08-21 12:22:45,133 (Elapsed: 00:47:00) train 6299 4236.303711
2022-08-21 12:23:16,465 (Elapsed: 00:47:31) train 6399 3977.401367
2022-08-21 12:23:47,973 (Elapsed: 00:48:03) train 6499 3953.143799
2022-08-21 12:24:19,402 (Elapsed: 00:48:34) train 6599 3904.244873
2022-08-21 12:24:50,911 (Elapsed: 00:49:06) train 6699 3898.207764
2022-08-21 12:25:22,151 (Elapsed: 00:49:37) train 6799 3873.312012
2022-08-21 12:25:53,465 (Elapsed: 00:50:08) train 6899 3849.422363
2022-08-21 12:26:24,505 (Elapsed: 00:50:39) train 6999 3811.093262
2022-08-21 12:26:33,616 (Elapsed: 00:50:48) train_nelbo 3811.418701
2022-08-21 12:28:14,626 (Elapsed: 00:52:29) val, step: 156, NELBO: 189117.531250, neg Log p 188831.453125
2022-08-21 12:28:14,627 (Elapsed: 00:52:29) valid_nelbo 189117.531250
2022-08-21 12:28:14,627 (Elapsed: 00:52:29) valid neg log p 188831.453125
2022-08-21 12:28:14,627 (Elapsed: 00:52:29) valid bpd elbo 88.814758
2022-08-21 12:28:14,628 (Elapsed: 00:52:29) valid bpd log p 88.680405
2022-08-21 12:28:14,628 (Elapsed: 00:52:29) KL distance 18247.214844
2022-08-21 12:28:14,631 (Elapsed: 00:52:29) saving the model.
2022-08-21 12:28:15,130 (Elapsed: 00:52:30) epoch 9
2022-08-21 12:28:38,021 (Elapsed: 00:52:53) train 7099 3130.810059
2022-08-21 12:29:09,445 (Elapsed: 00:53:24) train 7199 3123.489746
2022-08-21 12:29:40,531 (Elapsed: 00:53:55) train 7299 3083.382568
2022-08-21 12:30:11,743 (Elapsed: 00:54:27) train 7399 3060.825684
2022-08-21 12:30:43,174 (Elapsed: 00:54:58) train 7499 3039.965820
2022-08-21 12:31:15,610 (Elapsed: 00:55:30) train 7599 3034.138916
2022-08-21 12:31:46,817 (Elapsed: 00:56:02) train 7699 3016.521484
2022-08-21 12:32:18,029 (Elapsed: 00:56:33) train 7799 3001.531006
2022-08-21 12:32:21,293 (Elapsed: 00:56:36) train_nelbo 3000.521484
2022-08-21 12:34:02,520 (Elapsed: 00:58:17) val, step: 156, NELBO: 206575.515625, neg Log p 206279.578125
2022-08-21 12:34:02,521 (Elapsed: 00:58:17) valid_nelbo 206575.515625
2022-08-21 12:34:02,521 (Elapsed: 00:58:17) valid neg log p 206279.578125
2022-08-21 12:34:02,521 (Elapsed: 00:58:17) valid bpd elbo 97.013504
2022-08-21 12:34:02,521 (Elapsed: 00:58:17) valid bpd log p 96.874519
2022-08-21 12:34:02,521 (Elapsed: 00:58:17) KL distance 19856.519531
2022-08-21 12:34:02,523 (Elapsed: 00:58:17) saving the model.
2022-08-21 12:34:02,991 (Elapsed: 00:58:18) epoch 10
2022-08-21 12:34:32,221 (Elapsed: 00:58:47) train 7899 2496.502686
2022-08-21 12:35:03,696 (Elapsed: 00:59:18) train 7999 2400.229004
2022-08-21 12:35:35,514 (Elapsed: 00:59:50) train 8099 2379.495605
2022-08-21 12:36:07,717 (Elapsed: 01:00:22) train 8199 2355.505615
2022-08-21 12:36:39,680 (Elapsed: 01:00:54) train 8299 2343.767822
2022-08-21 12:37:11,850 (Elapsed: 01:01:27) train 8399 2331.369141
2022-08-21 12:37:42,965 (Elapsed: 01:01:58) train 8499 2322.166992
2022-08-21 12:38:11,189 (Elapsed: 01:02:26) train_nelbo 2322.887939
2022-08-21 12:39:52,777 (Elapsed: 01:04:08) val, step: 156, NELBO: 213890.671875, neg Log p 213596.875000
2022-08-21 12:39:52,777 (Elapsed: 01:04:08) valid_nelbo 213890.671875
2022-08-21 12:39:52,777 (Elapsed: 01:04:08) valid neg log p 213596.875000
2022-08-21 12:39:52,778 (Elapsed: 01:04:08) valid bpd elbo 100.448898
2022-08-21 12:39:52,778 (Elapsed: 01:04:08) valid bpd log p 100.310921
2022-08-21 12:39:52,778 (Elapsed: 01:04:08) KL distance 20849.609375
2022-08-21 12:39:52,779 (Elapsed: 01:04:08) saving the model.
2022-08-21 12:39:53,226 (Elapsed: 01:04:08) epoch 11
2022-08-21 12:39:56,916 (Elapsed: 01:04:12) train 8599 2227.199707
2022-08-21 12:40:29,418 (Elapsed: 01:04:44) train 8699 2077.318115
2022-08-21 12:41:00,519 (Elapsed: 01:05:15) train 8799 2058.400391
2022-08-21 12:41:31,807 (Elapsed: 01:05:47) train 8899 2055.343750
2022-08-21 12:42:03,378 (Elapsed: 01:06:18) train 8999 2046.171997
2022-08-21 12:42:34,577 (Elapsed: 01:06:49) train 9099 2043.417603
2022-08-21 12:43:05,737 (Elapsed: 01:07:21) train 9199 2038.401123
2022-08-21 12:43:37,358 (Elapsed: 01:07:52) train 9299 2034.566528
2022-08-21 12:43:59,937 (Elapsed: 01:08:15) train_nelbo 2027.942261
2022-08-21 12:45:41,085 (Elapsed: 01:09:56) val, step: 156, NELBO: 219450.000000, neg Log p 219151.515625
2022-08-21 12:45:41,086 (Elapsed: 01:09:56) valid_nelbo 219450.000000
2022-08-21 12:45:41,086 (Elapsed: 01:09:56) valid neg log p 219151.515625
2022-08-21 12:45:41,086 (Elapsed: 01:09:56) valid bpd elbo 103.059708
2022-08-21 12:45:41,086 (Elapsed: 01:09:56) valid bpd log p 102.919533
2022-08-21 12:45:41,086 (Elapsed: 01:09:56) KL distance 21184.427734
2022-08-21 12:45:41,088 (Elapsed: 01:09:56) saving the model.
