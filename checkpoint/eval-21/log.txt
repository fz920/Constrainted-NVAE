2022-08-21 14:48:27,135 (Elapsed: 00:00:04) args = Namespace(ada_groups=False, arch_instance='res_mbconv', batch_size=64, cont_training=False, data='/data/users/fz920/data/cifar10', dataset='cifar10', distributed=True, epochs=12, fast_adamax=True, global_rank=0, kl_anneal_portion=0.3, kl_const_coeff=0.0001, kl_const_portion=0.0001, learning_rate=0.005, learning_rate_min=0.0001, local_rank=0, master_address='127.0.0.1', min_groups_per_scale=1, node_rank=0, num_cell_per_cond_dec=2, num_cell_per_cond_enc=2, num_channels_dec=32, num_channels_enc=32, num_groups_per_scale=10, num_latent_per_group=20, num_latent_scales=1, num_mixture_dec=10, num_nf=0, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=2, num_proc_node=1, num_process_per_node=1, num_total_iter=9372, num_x_bits=8, res_dist=True, root='/data/users/fz920/Constrainted-NVAE/checkpoint', save='/data/users/fz920/Constrainted-NVAE/checkpoint/eval-21', seed=1, use_se=True, warmup_epochs=5, weight_decay=0.0003, weight_decay_norm=0.05, weight_decay_norm_anneal=False, weight_decay_norm_init=10.0)
2022-08-21 14:48:27,144 (Elapsed: 00:00:04) param size = 3.108576M 
2022-08-21 14:48:27,144 (Elapsed: 00:00:04) groups per scale: [10], total_groups: 10
2022-08-21 14:48:27,147 (Elapsed: 00:00:04) epoch 0
2022-08-21 14:48:57,231 (Elapsed: 00:00:34) train 99 18601.345703
2022-08-21 14:49:26,135 (Elapsed: 00:01:03) train 199 16478.449219
2022-08-21 14:49:55,140 (Elapsed: 00:01:32) train 299 15179.294922
2022-08-21 14:50:24,149 (Elapsed: 00:02:01) train 399 14369.984375
2022-08-21 14:50:53,154 (Elapsed: 00:02:30) train 499 13787.414062
2022-08-21 14:51:22,337 (Elapsed: 00:02:59) train 599 13343.540039
2022-08-21 14:51:51,504 (Elapsed: 00:03:28) train 699 12995.852539
2022-08-21 14:52:15,266 (Elapsed: 00:03:52) train_nelbo 12771.193359
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) val, step: 156, NELBO: 110615.804688, neg Log p 110322.851562
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) valid_nelbo 110615.804688
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) valid neg log p 110322.851562
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) valid bpd elbo 51.948200
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) valid bpd log p 51.810623
2022-08-21 14:53:55,348 (Elapsed: 00:05:32) KL distance 10090.835938
2022-08-21 14:53:55,350 (Elapsed: 00:05:32) saving the model.
2022-08-21 14:53:55,477 (Elapsed: 00:05:32) epoch 1
2022-08-21 14:54:02,515 (Elapsed: 00:05:39) train 799 10521.756836
2022-08-21 14:54:33,401 (Elapsed: 00:06:10) train 899 10512.108398
2022-08-21 14:55:06,613 (Elapsed: 00:06:44) train 999 10395.058594
2022-08-21 14:55:40,505 (Elapsed: 00:07:17) train 1099 10316.529297
2022-08-21 14:56:13,437 (Elapsed: 00:07:50) train 1199 10247.949219
2022-08-21 14:56:44,935 (Elapsed: 00:08:22) train 1299 10151.569336
2022-08-21 14:57:17,515 (Elapsed: 00:08:54) train 1399 10085.521484
2022-08-21 14:57:50,664 (Elapsed: 00:09:28) train 1499 10012.358398
2022-08-21 14:58:11,807 (Elapsed: 00:09:49) train_nelbo 9957.994141
2022-08-21 14:59:58,895 (Elapsed: 00:11:36) val, step: 156, NELBO: 139421.390625, neg Log p 139094.546875
2022-08-21 14:59:58,895 (Elapsed: 00:11:36) valid_nelbo 139421.390625
2022-08-21 14:59:58,895 (Elapsed: 00:11:36) valid neg log p 139094.546875
2022-08-21 14:59:58,895 (Elapsed: 00:11:36) valid bpd elbo 65.476089
2022-08-21 14:59:58,896 (Elapsed: 00:11:36) valid bpd log p 65.322594
2022-08-21 14:59:58,896 (Elapsed: 00:11:36) KL distance 12967.720703
2022-08-21 14:59:58,897 (Elapsed: 00:11:36) saving the model.
2022-08-21 14:59:59,471 (Elapsed: 00:11:36) epoch 2
2022-08-21 15:00:11,186 (Elapsed: 00:11:48) train 1599 9358.012695
2022-08-21 15:00:41,113 (Elapsed: 00:12:18) train 1699 9272.892578
2022-08-21 15:01:13,870 (Elapsed: 00:12:51) train 1799 9166.734375
2022-08-21 15:01:46,077 (Elapsed: 00:13:23) train 1899 9098.014648
2022-08-21 15:02:18,081 (Elapsed: 00:13:55) train 1999 9007.138672
2022-08-21 15:02:50,683 (Elapsed: 00:14:28) train 2099 8917.706055
2022-08-21 15:03:24,277 (Elapsed: 00:15:01) train 2199 8841.103516
2022-08-21 15:03:57,081 (Elapsed: 00:15:34) train 2299 8770.674805
2022-08-21 15:04:11,029 (Elapsed: 00:15:48) train_nelbo 8734.940430
2022-08-21 15:05:55,374 (Elapsed: 00:17:32) val, step: 156, NELBO: 142018.890625, neg Log p 141732.671875
2022-08-21 15:05:55,374 (Elapsed: 00:17:32) valid_nelbo 142018.890625
2022-08-21 15:05:55,374 (Elapsed: 00:17:32) valid neg log p 141732.671875
2022-08-21 15:05:55,374 (Elapsed: 00:17:32) valid bpd elbo 66.695946
2022-08-21 15:05:55,375 (Elapsed: 00:17:32) valid bpd log p 66.561531
2022-08-21 15:05:55,375 (Elapsed: 00:17:32) KL distance 13311.465820
2022-08-21 15:05:55,376 (Elapsed: 00:17:32) saving the model.
2022-08-21 15:05:55,813 (Elapsed: 00:17:33) epoch 3
2022-08-21 15:06:13,054 (Elapsed: 00:17:50) train 2399 7869.112305
2022-08-21 15:06:42,541 (Elapsed: 00:18:19) train 2499 8082.788574
2022-08-21 15:07:12,007 (Elapsed: 00:18:49) train 2599 8085.920898
2022-08-21 15:07:41,325 (Elapsed: 00:19:18) train 2699 8038.405762
2022-08-21 15:08:10,955 (Elapsed: 00:19:48) train 2799 8004.834473
2022-08-21 15:08:40,274 (Elapsed: 00:20:17) train 2899 7925.528809
2022-08-21 15:09:09,967 (Elapsed: 00:20:47) train 2999 7872.919434
2022-08-21 15:09:39,580 (Elapsed: 00:21:17) train 3099 7823.307617
2022-08-21 15:09:46,702 (Elapsed: 00:21:24) train_nelbo 7803.242676
2022-08-21 15:11:25,782 (Elapsed: 00:23:03) val, step: 156, NELBO: 146401.750000, neg Log p 146124.609375
2022-08-21 15:11:25,783 (Elapsed: 00:23:03) valid_nelbo 146401.750000
2022-08-21 15:11:25,783 (Elapsed: 00:23:03) valid neg log p 146124.609375
2022-08-21 15:11:25,783 (Elapsed: 00:23:03) valid bpd elbo 68.754257
2022-08-21 15:11:25,783 (Elapsed: 00:23:03) valid bpd log p 68.624107
2022-08-21 15:11:25,783 (Elapsed: 00:23:03) KL distance 13812.987305
2022-08-21 15:11:25,785 (Elapsed: 00:23:03) saving the model.
2022-08-21 15:11:26,320 (Elapsed: 00:23:03) epoch 4
2022-08-21 15:11:49,273 (Elapsed: 00:23:26) train 3199 7383.496582
2022-08-21 15:12:18,664 (Elapsed: 00:23:56) train 3299 7301.737305
2022-08-21 15:12:48,112 (Elapsed: 00:24:25) train 3399 7289.554199
2022-08-21 15:13:17,605 (Elapsed: 00:24:55) train 3499 7276.771484
2022-08-21 15:13:48,059 (Elapsed: 00:25:25) train 3599 7192.349609
2022-08-21 15:14:20,990 (Elapsed: 00:25:58) train 3699 7137.393066
2022-08-21 15:14:54,606 (Elapsed: 00:26:32) train 3799 7084.712891
2022-08-21 15:15:26,181 (Elapsed: 00:27:03) train 3899 7005.801758
2022-08-21 15:15:28,050 (Elapsed: 00:27:05) train_nelbo 6999.210938
2022-08-21 15:17:09,314 (Elapsed: 00:28:46) val, step: 156, NELBO: 146611.781250, neg Log p 146346.500000
2022-08-21 15:17:09,314 (Elapsed: 00:28:46) valid_nelbo 146611.781250
2022-08-21 15:17:09,315 (Elapsed: 00:28:46) valid neg log p 146346.500000
2022-08-21 15:17:09,315 (Elapsed: 00:28:46) valid bpd elbo 68.852898
2022-08-21 15:17:09,315 (Elapsed: 00:28:46) valid bpd log p 68.728310
2022-08-21 15:17:09,315 (Elapsed: 00:28:46) KL distance 13898.909180
2022-08-21 15:17:09,317 (Elapsed: 00:28:46) saving the model.
2022-08-21 15:17:09,836 (Elapsed: 00:28:47) epoch 5
2022-08-21 15:17:38,432 (Elapsed: 00:29:15) train 3999 6401.964844
2022-08-21 15:18:08,073 (Elapsed: 00:29:45) train 4099 6396.722168
2022-08-21 15:18:37,349 (Elapsed: 00:30:14) train 4199 6320.593750
2022-08-21 15:19:06,944 (Elapsed: 00:30:44) train 4299 6254.019531
2022-08-21 15:19:36,667 (Elapsed: 00:31:14) train 4399 6198.367676
2022-08-21 15:20:06,028 (Elapsed: 00:31:43) train 4499 6136.971191
2022-08-21 15:20:35,545 (Elapsed: 00:32:12) train 4599 6075.744629
2022-08-21 15:21:01,020 (Elapsed: 00:32:38) train_nelbo 6071.188965
2022-08-21 15:22:40,304 (Elapsed: 00:34:17) val, step: 156, NELBO: 146972.296875, neg Log p 146711.140625
2022-08-21 15:22:40,304 (Elapsed: 00:34:17) valid_nelbo 146972.296875
2022-08-21 15:22:40,304 (Elapsed: 00:34:17) valid neg log p 146711.140625
2022-08-21 15:22:40,304 (Elapsed: 00:34:17) valid bpd elbo 69.022202
2022-08-21 15:22:40,304 (Elapsed: 00:34:17) valid bpd log p 68.899559
2022-08-21 15:22:40,305 (Elapsed: 00:34:17) KL distance 13905.950195
2022-08-21 15:22:40,306 (Elapsed: 00:34:17) saving the model.
2022-08-21 15:22:40,749 (Elapsed: 00:34:18) epoch 6
2022-08-21 15:22:45,477 (Elapsed: 00:34:22) train 4699 5349.752441
2022-08-21 15:23:14,933 (Elapsed: 00:34:52) train 4799 5450.574707
2022-08-21 15:23:44,426 (Elapsed: 00:35:21) train 4899 5481.683105
2022-08-21 15:24:13,837 (Elapsed: 00:35:51) train 4999 5430.049805
2022-08-21 15:24:43,278 (Elapsed: 00:36:20) train 5099 5385.719727
2022-08-21 15:25:12,671 (Elapsed: 00:36:50) train 5199 5381.814941
2022-08-21 15:25:42,089 (Elapsed: 00:37:19) train 5299 5343.235840
2022-08-21 15:26:11,482 (Elapsed: 00:37:48) train 5399 5326.501953
2022-08-21 15:26:31,169 (Elapsed: 00:38:08) train_nelbo 5325.314941
2022-08-21 15:28:09,746 (Elapsed: 00:39:47) val, step: 156, NELBO: 163788.546875, neg Log p 163519.078125
2022-08-21 15:28:09,746 (Elapsed: 00:39:47) valid_nelbo 163788.546875
2022-08-21 15:28:09,746 (Elapsed: 00:39:47) valid neg log p 163519.078125
2022-08-21 15:28:09,747 (Elapsed: 00:39:47) valid bpd elbo 76.919571
2022-08-21 15:28:09,747 (Elapsed: 00:39:47) valid bpd log p 76.793022
2022-08-21 15:28:09,747 (Elapsed: 00:39:47) KL distance 15461.612305
2022-08-21 15:28:09,748 (Elapsed: 00:39:47) saving the model.
2022-08-21 15:28:10,334 (Elapsed: 00:39:47) epoch 7
2022-08-21 15:28:20,627 (Elapsed: 00:39:58) train 5499 4986.391113
2022-08-21 15:28:50,244 (Elapsed: 00:40:27) train 5599 5074.229004
2022-08-21 15:29:19,927 (Elapsed: 00:40:57) train 5699 4991.510742
2022-08-21 15:29:49,331 (Elapsed: 00:41:26) train 5799 4927.121094
2022-08-21 15:30:18,902 (Elapsed: 00:41:56) train 5899 4869.598633
2022-08-21 15:30:48,505 (Elapsed: 00:42:25) train 5999 4827.970703
2022-08-21 15:31:18,247 (Elapsed: 00:42:55) train 6099 4781.032715
2022-08-21 15:31:47,970 (Elapsed: 00:43:25) train 6199 4734.605469
2022-08-21 15:32:02,558 (Elapsed: 00:43:39) train_nelbo 4722.989746
2022-08-21 15:33:41,549 (Elapsed: 00:45:18) val, step: 156, NELBO: 164033.234375, neg Log p 163772.546875
2022-08-21 15:33:41,550 (Elapsed: 00:45:18) valid_nelbo 164033.234375
2022-08-21 15:33:41,550 (Elapsed: 00:45:18) valid neg log p 163772.546875
2022-08-21 15:33:41,550 (Elapsed: 00:45:18) valid bpd elbo 77.034485
2022-08-21 15:33:41,550 (Elapsed: 00:45:18) valid bpd log p 76.912056
2022-08-21 15:33:41,551 (Elapsed: 00:45:18) KL distance 15837.377930
2022-08-21 15:33:41,553 (Elapsed: 00:45:18) saving the model.
2022-08-21 15:33:42,067 (Elapsed: 00:45:19) epoch 8
2022-08-21 15:33:58,027 (Elapsed: 00:45:35) train 6299 4084.464355
2022-08-21 15:34:27,602 (Elapsed: 00:46:05) train 6399 3983.763916
2022-08-21 15:34:57,265 (Elapsed: 00:46:34) train 6499 3908.942627
2022-08-21 15:35:27,367 (Elapsed: 00:47:04) train 6599 3862.580322
2022-08-21 15:36:00,117 (Elapsed: 00:47:37) train 6699 3842.864746
2022-08-21 15:36:33,542 (Elapsed: 00:48:10) train 6799 3823.214355
2022-08-21 15:37:03,969 (Elapsed: 00:48:41) train 6899 3813.266846
2022-08-21 15:37:36,761 (Elapsed: 00:49:14) train 6999 3783.968750
2022-08-21 15:37:45,407 (Elapsed: 00:49:22) train_nelbo 3784.044922
2022-08-21 15:39:23,913 (Elapsed: 00:51:01) val, step: 156, NELBO: 193962.906250, neg Log p 193683.687500
2022-08-21 15:39:23,914 (Elapsed: 00:51:01) valid_nelbo 193962.906250
2022-08-21 15:39:23,914 (Elapsed: 00:51:01) valid neg log p 193683.687500
2022-08-21 15:39:23,914 (Elapsed: 00:51:01) valid bpd elbo 91.090279
2022-08-21 15:39:23,914 (Elapsed: 00:51:01) valid bpd log p 90.959145
2022-08-21 15:39:23,915 (Elapsed: 00:51:01) KL distance 18684.121094
2022-08-21 15:39:23,917 (Elapsed: 00:51:01) saving the model.
2022-08-21 15:39:24,354 (Elapsed: 00:51:01) epoch 9
2022-08-21 15:39:46,102 (Elapsed: 00:51:23) train 7099 3150.979980
2022-08-21 15:40:17,458 (Elapsed: 00:51:54) train 7199 3199.280762
2022-08-21 15:40:48,990 (Elapsed: 00:52:26) train 7299 3178.019287
2022-08-21 15:41:19,140 (Elapsed: 00:52:56) train 7399 3143.366211
2022-08-21 15:41:49,394 (Elapsed: 00:53:26) train 7499 3099.799072
2022-08-21 15:42:19,470 (Elapsed: 00:53:56) train 7599 3082.852295
2022-08-21 15:42:48,895 (Elapsed: 00:54:26) train 7699 3062.311523
2022-08-21 15:43:18,956 (Elapsed: 00:54:56) train 7799 3041.437500
2022-08-21 15:43:22,064 (Elapsed: 00:54:59) train_nelbo 3039.817871
2022-08-21 15:45:00,837 (Elapsed: 00:56:38) val, step: 156, NELBO: 202534.000000, neg Log p 202250.343750
2022-08-21 15:45:00,837 (Elapsed: 00:56:38) valid_nelbo 202534.000000
2022-08-21 15:45:00,837 (Elapsed: 00:56:38) valid neg log p 202250.343750
2022-08-21 15:45:00,837 (Elapsed: 00:56:38) valid bpd elbo 95.115494
2022-08-21 15:45:00,838 (Elapsed: 00:56:38) valid bpd log p 94.982285
2022-08-21 15:45:00,838 (Elapsed: 00:56:38) KL distance 19597.259766
2022-08-21 15:45:00,839 (Elapsed: 00:56:38) saving the model.
2022-08-21 15:45:01,393 (Elapsed: 00:56:38) epoch 10
2022-08-21 15:45:33,019 (Elapsed: 00:57:10) train 7899 2522.858643
2022-08-21 15:46:04,612 (Elapsed: 00:57:42) train 7999 2420.283447
2022-08-21 15:46:37,787 (Elapsed: 00:58:15) train 8099 2404.812744
2022-08-21 15:47:08,954 (Elapsed: 00:58:46) train 8199 2373.880859
2022-08-21 15:47:41,519 (Elapsed: 00:59:18) train 8299 2358.048828
2022-08-21 15:48:14,653 (Elapsed: 00:59:52) train 8399 2342.821045
2022-08-21 15:48:44,615 (Elapsed: 01:00:22) train 8499 2333.608887
2022-08-21 15:49:12,588 (Elapsed: 01:00:50) train_nelbo 2331.583496
2022-08-21 15:50:57,856 (Elapsed: 01:02:35) val, step: 156, NELBO: 212619.828125, neg Log p 212334.375000
2022-08-21 15:50:57,857 (Elapsed: 01:02:35) valid_nelbo 212619.828125
2022-08-21 15:50:57,857 (Elapsed: 01:02:35) valid neg log p 212334.375000
2022-08-21 15:50:57,857 (Elapsed: 01:02:35) valid bpd elbo 99.852074
2022-08-21 15:50:57,857 (Elapsed: 01:02:35) valid bpd log p 99.718018
2022-08-21 15:50:57,857 (Elapsed: 01:02:35) KL distance 20660.193359
2022-08-21 15:50:57,859 (Elapsed: 01:02:35) saving the model.
2022-08-21 15:50:58,407 (Elapsed: 01:02:35) epoch 11
2022-08-21 15:51:02,120 (Elapsed: 01:02:39) train 8599 2237.509766
2022-08-21 15:51:32,857 (Elapsed: 01:03:10) train 8699 2087.878174
2022-08-21 15:52:03,181 (Elapsed: 01:03:40) train 8799 2070.708984
2022-08-21 15:52:33,610 (Elapsed: 01:04:11) train 8899 2068.318359
2022-08-21 15:53:06,450 (Elapsed: 01:04:43) train 8999 2058.227295
2022-08-21 15:53:37,056 (Elapsed: 01:05:14) train 9099 2055.323975
2022-08-21 15:54:07,878 (Elapsed: 01:05:45) train 9199 2050.948730
2022-08-21 15:54:42,140 (Elapsed: 01:06:19) train 9299 2047.434814
2022-08-21 15:55:04,364 (Elapsed: 01:06:41) train_nelbo 2040.227661
2022-08-21 15:56:48,770 (Elapsed: 01:08:26) val, step: 156, NELBO: 218586.109375, neg Log p 218295.343750
2022-08-21 15:56:48,771 (Elapsed: 01:08:26) valid_nelbo 218586.109375
2022-08-21 15:56:48,771 (Elapsed: 01:08:26) valid neg log p 218295.343750
2022-08-21 15:56:48,772 (Elapsed: 01:08:26) valid bpd elbo 102.654007
2022-08-21 15:56:48,772 (Elapsed: 01:08:26) valid bpd log p 102.517448
2022-08-21 15:56:48,773 (Elapsed: 01:08:26) KL distance 21072.566406
2022-08-21 15:56:48,775 (Elapsed: 01:08:26) saving the model.
