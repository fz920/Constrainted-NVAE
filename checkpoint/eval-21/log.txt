2022-09-03 12:24:20,286 (Elapsed: 00:00:19) args = Namespace(ada_groups=False, arch_instance='res_mbconv', batch_size=64, cont_training=False, data='/data/users/fz920/data/cifar10', dataset='cifar10', distributed=True, epochs=10, fast_adamax=True, global_rank=0, kl_anneal_portion=0.3, kl_const_coeff=0.0001, kl_const_portion=0.0001, learning_rate=0.005, learning_rate_min=0.0001, local_rank=0, master_address='127.0.0.1', min_groups_per_scale=1, node_rank=0, num_cell_per_cond_dec=2, num_cell_per_cond_enc=2, num_channels_dec=32, num_channels_enc=32, num_groups_per_scale=10, num_latent_per_group=20, num_latent_scales=1, num_mixture_dec=10, num_nf=0, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=2, num_proc_node=1, num_process_per_node=1, num_total_iter=7810, num_x_bits=8, res_dist=True, root='/data/users/fz920/Constrainted-NVAE/checkpoint', save='/data/users/fz920/Constrainted-NVAE/checkpoint/eval-21', seed=1, use_se=True, warmup_epochs=5, weight_decay=0.0003, weight_decay_norm=0.05, weight_decay_norm_anneal=False, weight_decay_norm_init=10.0)
2022-09-03 12:24:20,302 (Elapsed: 00:00:19) param size = 3.108576M 
2022-09-03 12:24:20,302 (Elapsed: 00:00:19) groups per scale: [10], total_groups: 10
2022-09-03 12:24:20,307 (Elapsed: 00:00:19) epoch 0
2022-09-03 12:25:11,293 (Elapsed: 00:01:10) train 99 18601.361328
2022-09-03 12:26:01,223 (Elapsed: 00:02:00) train 199 16478.607422
2022-09-03 12:26:49,856 (Elapsed: 00:02:49) train 299 15183.086914
2022-09-03 12:27:41,161 (Elapsed: 00:03:40) train 399 14376.292969
2022-09-03 12:28:33,829 (Elapsed: 00:04:33) train 499 13784.947266
2022-09-03 12:29:24,712 (Elapsed: 00:05:24) train 599 13339.300781
2022-09-03 12:30:15,758 (Elapsed: 00:06:15) train 699 12986.244141
2022-09-03 12:30:55,482 (Elapsed: 00:06:54) train_nelbo 12757.374023
2022-09-03 12:33:31,365 (Elapsed: 00:09:30) val, step: 156, NELBO: 110912.164062, neg Log p 110623.507812
2022-09-03 12:33:31,370 (Elapsed: 00:09:30) valid_nelbo 110912.164062
2022-09-03 12:33:31,370 (Elapsed: 00:09:30) valid neg log p 110623.507812
2022-09-03 12:33:31,370 (Elapsed: 00:09:30) valid bpd elbo 52.087379
2022-09-03 12:33:31,371 (Elapsed: 00:09:30) valid bpd log p 51.951820
2022-09-03 12:33:31,371 (Elapsed: 00:09:30) KL distance 10118.347656
2022-09-03 12:33:31,373 (Elapsed: 00:09:30) saving the model.
2022-09-03 12:33:31,566 (Elapsed: 00:09:31) epoch 1
2022-09-03 12:33:41,553 (Elapsed: 00:09:41) train 799 10455.977539
2022-09-03 12:34:30,006 (Elapsed: 00:10:29) train 899 10456.374023
2022-09-03 12:35:23,722 (Elapsed: 00:11:23) train 999 10411.873047
2022-09-03 12:36:12,875 (Elapsed: 00:12:12) train 1099 10330.083008
2022-09-03 12:37:05,428 (Elapsed: 00:13:04) train 1199 10244.702148
2022-09-03 12:37:55,630 (Elapsed: 00:13:55) train 1299 10142.862305
2022-09-03 12:38:49,325 (Elapsed: 00:14:48) train 1399 10078.287109
2022-09-03 12:39:38,097 (Elapsed: 00:15:37) train 1499 10005.038086
2022-09-03 12:40:08,338 (Elapsed: 00:16:07) train_nelbo 9953.307617
2022-09-03 12:42:44,965 (Elapsed: 00:18:44) val, step: 156, NELBO: 141022.828125, neg Log p 140663.296875
2022-09-03 12:42:44,970 (Elapsed: 00:18:44) valid_nelbo 141022.828125
2022-09-03 12:42:44,971 (Elapsed: 00:18:44) valid neg log p 140663.296875
2022-09-03 12:42:44,971 (Elapsed: 00:18:44) valid bpd elbo 66.228172
2022-09-03 12:42:44,971 (Elapsed: 00:18:44) valid bpd log p 66.059326
2022-09-03 12:42:44,971 (Elapsed: 00:18:44) KL distance 13268.754883
2022-09-03 12:42:44,974 (Elapsed: 00:18:44) saving the model.
2022-09-03 12:42:45,754 (Elapsed: 00:18:45) epoch 2
2022-09-03 12:43:07,721 (Elapsed: 00:19:07) train 1599 9316.595703
2022-09-03 12:43:55,626 (Elapsed: 00:19:55) train 1699 9272.353516
2022-09-03 12:44:46,403 (Elapsed: 00:20:45) train 1799 9136.335938
2022-09-03 12:45:37,912 (Elapsed: 00:21:37) train 1899 9073.438477
2022-09-03 12:46:31,580 (Elapsed: 00:22:31) train 1999 8981.298828
2022-09-03 12:47:20,224 (Elapsed: 00:23:19) train 2099 8891.113281
2022-09-03 12:48:08,522 (Elapsed: 00:24:07) train 2199 8853.858398
2022-09-03 12:48:58,156 (Elapsed: 00:24:57) train 2299 8795.776367
2022-09-03 12:49:18,716 (Elapsed: 00:25:18) train_nelbo 8765.983398
2022-09-03 12:51:57,469 (Elapsed: 00:27:56) val, step: 156, NELBO: 139883.671875, neg Log p 139609.281250
2022-09-03 12:51:57,475 (Elapsed: 00:27:56) valid_nelbo 139883.671875
2022-09-03 12:51:57,475 (Elapsed: 00:27:56) valid neg log p 139609.281250
2022-09-03 12:51:57,476 (Elapsed: 00:27:56) valid bpd elbo 65.693192
2022-09-03 12:51:57,476 (Elapsed: 00:27:56) valid bpd log p 65.564331
2022-09-03 12:51:57,477 (Elapsed: 00:27:56) KL distance 13196.548828
2022-09-03 12:51:57,478 (Elapsed: 00:27:56) saving the model.
2022-09-03 12:51:58,071 (Elapsed: 00:27:57) epoch 3
2022-09-03 12:52:27,586 (Elapsed: 00:28:27) train 2399 7914.203613
2022-09-03 12:53:17,665 (Elapsed: 00:29:17) train 2499 8026.520996
2022-09-03 12:54:08,359 (Elapsed: 00:30:07) train 2599 8023.778320
2022-09-03 12:54:56,224 (Elapsed: 00:30:55) train 2699 7939.862305
2022-09-03 12:55:45,370 (Elapsed: 00:31:44) train 2799 7887.945801
2022-09-03 12:56:34,709 (Elapsed: 00:32:34) train 2899 7825.017090
2022-09-03 12:57:25,445 (Elapsed: 00:33:24) train 2999 7780.572266
2022-09-03 12:58:16,296 (Elapsed: 00:34:15) train 3099 7715.829102
2022-09-03 12:58:29,024 (Elapsed: 00:34:28) train_nelbo 7694.791992
2022-09-03 13:01:03,748 (Elapsed: 00:37:03) val, step: 156, NELBO: 148826.421875, neg Log p 148552.218750
2022-09-03 13:01:03,753 (Elapsed: 00:37:03) valid_nelbo 148826.421875
2022-09-03 13:01:03,796 (Elapsed: 00:37:03) valid neg log p 148552.218750
2022-09-03 13:01:03,797 (Elapsed: 00:37:03) valid bpd elbo 69.892952
2022-09-03 13:01:03,797 (Elapsed: 00:37:03) valid bpd log p 69.764175
2022-09-03 13:01:03,798 (Elapsed: 00:37:03) KL distance 14123.791016
2022-09-03 13:01:03,800 (Elapsed: 00:37:03) saving the model.
2022-09-03 13:01:04,434 (Elapsed: 00:37:03) epoch 4
2022-09-03 13:01:45,226 (Elapsed: 00:37:44) train 3199 7183.440918
2022-09-03 13:02:36,277 (Elapsed: 00:38:35) train 3299 7184.547852
2022-09-03 13:03:27,100 (Elapsed: 00:39:26) train 3399 7179.087402
2022-09-03 13:04:14,928 (Elapsed: 00:40:14) train 3499 7084.752441
2022-09-03 13:05:04,420 (Elapsed: 00:41:03) train 3599 6987.050293
2022-09-03 13:05:53,893 (Elapsed: 00:41:53) train 3699 6921.827148
2022-09-03 13:06:44,428 (Elapsed: 00:42:43) train 3799 6880.682617
2022-09-03 13:07:32,467 (Elapsed: 00:43:31) train 3899 6811.496582
2022-09-03 13:07:35,707 (Elapsed: 00:43:35) train_nelbo 6807.722656
2022-09-03 13:10:10,162 (Elapsed: 00:46:09) val, step: 156, NELBO: 149819.187500, neg Log p 149551.750000
2022-09-03 13:10:10,169 (Elapsed: 00:46:09) valid_nelbo 149819.187500
2022-09-03 13:10:10,169 (Elapsed: 00:46:09) valid neg log p 149551.750000
2022-09-03 13:10:10,169 (Elapsed: 00:46:09) valid bpd elbo 70.359177
2022-09-03 13:10:10,169 (Elapsed: 00:46:09) valid bpd log p 70.233582
2022-09-03 13:10:10,170 (Elapsed: 00:46:09) KL distance 14218.217773
2022-09-03 13:10:10,171 (Elapsed: 00:46:09) saving the model.
2022-09-03 13:10:10,959 (Elapsed: 00:46:10) epoch 5
2022-09-03 13:10:57,928 (Elapsed: 00:46:57) train 3999 6240.447754
2022-09-03 13:11:46,861 (Elapsed: 00:47:46) train 4099 6214.105469
2022-09-03 13:12:38,438 (Elapsed: 00:48:37) train 4199 6170.508789
2022-09-03 13:13:27,557 (Elapsed: 00:49:27) train 4299 6084.827148
2022-09-03 13:14:19,312 (Elapsed: 00:50:18) train 4399 6038.797363
2022-09-03 13:15:09,858 (Elapsed: 00:51:09) train 4499 5999.577637
2022-09-03 13:16:00,251 (Elapsed: 00:51:59) train 4599 5945.473633
2022-09-03 13:16:40,985 (Elapsed: 00:52:40) train_nelbo 5893.870117
2022-09-03 13:19:17,839 (Elapsed: 00:55:17) val, step: 156, NELBO: 162588.656250, neg Log p 162318.500000
2022-09-03 13:19:17,845 (Elapsed: 00:55:17) valid_nelbo 162588.656250
2022-09-03 13:19:17,845 (Elapsed: 00:55:17) valid neg log p 162318.500000
2022-09-03 13:19:17,845 (Elapsed: 00:55:17) valid bpd elbo 76.356071
2022-09-03 13:19:17,846 (Elapsed: 00:55:17) valid bpd log p 76.229195
2022-09-03 13:19:17,846 (Elapsed: 00:55:17) KL distance 15444.225586
2022-09-03 13:19:17,848 (Elapsed: 00:55:17) saving the model.
2022-09-03 13:19:18,529 (Elapsed: 00:55:17) epoch 6
2022-09-03 13:19:27,411 (Elapsed: 00:55:26) train 4699 5526.271484
2022-09-03 13:20:17,063 (Elapsed: 00:56:16) train 4799 5289.429688
2022-09-03 13:21:07,584 (Elapsed: 00:57:07) train 4899 5290.811523
2022-09-03 13:21:55,325 (Elapsed: 00:57:54) train 4999 5243.412598
2022-09-03 13:22:45,364 (Elapsed: 00:58:44) train 5099 5237.767578
2022-09-03 13:23:33,949 (Elapsed: 00:59:33) train 5199 5203.891113
2022-09-03 13:24:20,736 (Elapsed: 01:00:20) train 5299 5181.450195
2022-09-03 13:25:08,340 (Elapsed: 01:01:07) train 5399 5142.642090
2022-09-03 13:25:42,472 (Elapsed: 01:01:41) train_nelbo 5143.596191
2022-09-03 13:28:16,479 (Elapsed: 01:04:15) val, step: 156, NELBO: 160166.375000, neg Log p 159901.109375
2022-09-03 13:28:16,485 (Elapsed: 01:04:15) valid_nelbo 160166.375000
2022-09-03 13:28:16,486 (Elapsed: 01:04:15) valid neg log p 159901.109375
2022-09-03 13:28:16,486 (Elapsed: 01:04:15) valid bpd elbo 75.218498
2022-09-03 13:28:16,486 (Elapsed: 01:04:15) valid bpd log p 75.093925
2022-09-03 13:28:16,487 (Elapsed: 01:04:15) KL distance 15298.041016
2022-09-03 13:28:16,489 (Elapsed: 01:04:15) saving the model.
2022-09-03 13:28:17,134 (Elapsed: 01:04:16) epoch 7
2022-09-03 13:28:32,697 (Elapsed: 01:04:32) train 5499 4343.634766
2022-09-03 13:29:24,137 (Elapsed: 01:05:23) train 5599 4435.285645
2022-09-03 13:30:12,802 (Elapsed: 01:06:12) train 5699 4377.962402
2022-09-03 13:31:05,602 (Elapsed: 01:07:05) train 5799 4318.218750
2022-09-03 13:31:57,007 (Elapsed: 01:07:56) train 5899 4304.027344
2022-09-03 13:32:46,329 (Elapsed: 01:08:45) train 5999 4278.892578
2022-09-03 13:33:35,655 (Elapsed: 01:09:35) train 6099 4233.408203
2022-09-03 13:34:24,816 (Elapsed: 01:10:24) train 6199 4183.211914
2022-09-03 13:34:48,242 (Elapsed: 01:10:47) train_nelbo 4174.036133
2022-09-03 13:37:24,443 (Elapsed: 01:13:23) val, step: 156, NELBO: 181218.468750, neg Log p 180949.031250
2022-09-03 13:37:24,449 (Elapsed: 01:13:23) valid_nelbo 181218.468750
2022-09-03 13:37:24,449 (Elapsed: 01:13:23) valid neg log p 180949.031250
2022-09-03 13:37:24,449 (Elapsed: 01:13:23) valid bpd elbo 85.105141
2022-09-03 13:37:24,449 (Elapsed: 01:13:23) valid bpd log p 84.978607
2022-09-03 13:37:24,450 (Elapsed: 01:13:23) KL distance 17471.316406
2022-09-03 13:37:24,452 (Elapsed: 01:13:23) saving the model.
2022-09-03 13:37:25,033 (Elapsed: 01:13:24) epoch 8
2022-09-03 13:37:50,925 (Elapsed: 01:13:50) train 6299 3305.921387
2022-09-03 13:38:41,130 (Elapsed: 01:14:40) train 6399 3176.540771
2022-09-03 13:39:28,092 (Elapsed: 01:15:27) train 6499 3160.997314
2022-09-03 13:40:20,717 (Elapsed: 01:16:20) train 6599 3137.840332
2022-09-03 13:41:08,306 (Elapsed: 01:17:07) train 6699 3094.385986
2022-09-03 13:41:56,959 (Elapsed: 01:17:56) train 6799 3074.428223
2022-09-03 13:42:46,863 (Elapsed: 01:18:46) train 6899 3064.319092
2022-09-03 13:43:36,038 (Elapsed: 01:19:35) train 6999 3048.672852
2022-09-03 13:43:49,528 (Elapsed: 01:19:48) train_nelbo 3047.078857
2022-09-03 13:46:23,946 (Elapsed: 01:22:23) val, step: 156, NELBO: 203768.406250, neg Log p 203484.531250
2022-09-03 13:46:23,951 (Elapsed: 01:22:23) valid_nelbo 203768.406250
2022-09-03 13:46:23,951 (Elapsed: 01:22:23) valid neg log p 203484.531250
2022-09-03 13:46:23,951 (Elapsed: 01:22:23) valid bpd elbo 95.695206
2022-09-03 13:46:23,951 (Elapsed: 01:22:23) valid bpd log p 95.561890
2022-09-03 13:46:23,952 (Elapsed: 01:22:23) KL distance 19758.363281
2022-09-03 13:46:23,954 (Elapsed: 01:22:23) saving the model.
2022-09-03 13:46:24,520 (Elapsed: 01:22:23) epoch 9
2022-09-03 13:47:00,921 (Elapsed: 01:23:00) train 7099 2508.175781
2022-09-03 13:47:49,471 (Elapsed: 01:23:48) train 7199 2485.536865
2022-09-03 13:48:39,308 (Elapsed: 01:24:38) train 7299 2469.739258
2022-09-03 13:49:28,881 (Elapsed: 01:25:28) train 7399 2454.897461
2022-09-03 13:50:19,008 (Elapsed: 01:26:18) train 7499 2447.874756
2022-09-03 13:51:11,293 (Elapsed: 01:27:10) train 7599 2448.105713
2022-09-03 13:51:59,944 (Elapsed: 01:27:59) train 7699 2445.491455
2022-09-03 13:52:51,422 (Elapsed: 01:28:50) train 7799 2436.957764
2022-09-03 13:52:56,439 (Elapsed: 01:28:55) train_nelbo 2436.492676
2022-09-03 13:55:29,153 (Elapsed: 01:31:28) val, step: 156, NELBO: 207733.781250, neg Log p 207443.890625
2022-09-03 13:55:29,159 (Elapsed: 01:31:28) valid_nelbo 207733.781250
2022-09-03 13:55:29,159 (Elapsed: 01:31:28) valid neg log p 207443.890625
2022-09-03 13:55:29,160 (Elapsed: 01:31:28) valid bpd elbo 97.557457
2022-09-03 13:55:29,160 (Elapsed: 01:31:28) valid bpd log p 97.421310
2022-09-03 13:55:29,161 (Elapsed: 01:31:28) KL distance 20266.087891
2022-09-03 13:55:29,163 (Elapsed: 01:31:28) saving the model.
