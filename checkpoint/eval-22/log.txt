2022-09-03 15:18:50,896 (Elapsed: 00:00:18) args = Namespace(ada_groups=False, arch_instance='res_mbconv', batch_size=64, cont_training=False, data='/data/users/fz920/data/cifar10', dataset='cifar10', distributed=True, epochs=10, fast_adamax=True, global_rank=0, kl_anneal_portion=0.3, kl_const_coeff=0.0001, kl_const_portion=0.0001, learning_rate=0.005, learning_rate_min=0.0001, local_rank=0, master_address='127.0.0.1', min_groups_per_scale=1, node_rank=0, num_cell_per_cond_dec=2, num_cell_per_cond_enc=2, num_channels_dec=32, num_channels_enc=32, num_groups_per_scale=10, num_latent_per_group=20, num_latent_scales=1, num_mixture_dec=10, num_nf=0, num_postprocess_blocks=1, num_postprocess_cells=2, num_preprocess_blocks=1, num_preprocess_cells=2, num_proc_node=1, num_process_per_node=1, num_total_iter=7810, num_x_bits=8, res_dist=True, root='/data/users/fz920/Constrainted-NVAE/checkpoint', save='/data/users/fz920/Constrainted-NVAE/checkpoint/eval-22', seed=1, use_se=True, warmup_epochs=5, weight_decay=0.0003, weight_decay_norm=0.05, weight_decay_norm_anneal=False, weight_decay_norm_init=10.0)
2022-09-03 15:18:50,916 (Elapsed: 00:00:18) param size = 3.108576M 
2022-09-03 15:18:50,916 (Elapsed: 00:00:18) groups per scale: [10], total_groups: 10
2022-09-03 15:18:50,921 (Elapsed: 00:00:18) epoch 0
2022-09-03 15:19:42,219 (Elapsed: 00:01:09) train 99 18650.085938
2022-09-03 15:20:30,320 (Elapsed: 00:01:57) train 199 16588.791016
2022-09-03 15:21:19,911 (Elapsed: 00:02:47) train 299 15315.095703
2022-09-03 15:22:10,438 (Elapsed: 00:03:37) train 399 14500.854492
2022-09-03 15:22:58,253 (Elapsed: 00:04:25) train 499 13902.943359
2022-09-03 15:23:47,124 (Elapsed: 00:05:14) train 599 13434.671875
2022-09-03 15:24:35,605 (Elapsed: 00:06:03) train 699 13063.765625
2022-09-03 15:25:16,510 (Elapsed: 00:06:44) train_nelbo 12827.800781
2022-09-03 15:27:56,029 (Elapsed: 00:09:23) val, step: 156, NELBO: 76023.460938, neg Log p 75730.875000
2022-09-03 15:27:56,034 (Elapsed: 00:09:23) valid_nelbo 76023.460938
2022-09-03 15:27:56,034 (Elapsed: 00:09:23) valid neg log p 75730.875000
2022-09-03 15:27:56,034 (Elapsed: 00:09:23) valid bpd elbo 35.702694
2022-09-03 15:27:56,036 (Elapsed: 00:09:23) valid bpd log p 35.565285
2022-09-03 15:27:56,044 (Elapsed: 00:09:23) KL distance 6703.139160
2022-09-03 15:27:56,047 (Elapsed: 00:09:23) saving the model.
2022-09-03 15:27:56,279 (Elapsed: 00:09:23) epoch 1
2022-09-03 15:28:06,382 (Elapsed: 00:09:33) train 799 10454.071289
2022-09-03 15:28:54,825 (Elapsed: 00:10:22) train 899 10425.678711
2022-09-03 15:29:45,107 (Elapsed: 00:11:12) train 999 10389.090820
2022-09-03 15:30:31,918 (Elapsed: 00:11:59) train 1099 10292.556641
2022-09-03 15:31:21,116 (Elapsed: 00:12:48) train 1199 10204.886719
2022-09-03 15:32:08,660 (Elapsed: 00:13:36) train 1299 10095.380859
2022-09-03 15:33:00,075 (Elapsed: 00:14:27) train 1399 10017.381836
2022-09-03 15:33:47,565 (Elapsed: 00:15:15) train 1499 9937.851562
2022-09-03 15:34:16,547 (Elapsed: 00:15:44) train_nelbo 9898.207031
2022-09-03 15:36:53,572 (Elapsed: 00:18:21) val, step: 156, NELBO: 88949.242188, neg Log p 88693.789062
2022-09-03 15:36:53,577 (Elapsed: 00:18:21) valid_nelbo 88949.242188
2022-09-03 15:36:53,578 (Elapsed: 00:18:21) valid neg log p 88693.789062
2022-09-03 15:36:53,578 (Elapsed: 00:18:21) valid bpd elbo 41.772991
2022-09-03 15:36:53,578 (Elapsed: 00:18:21) valid bpd log p 41.653023
2022-09-03 15:36:53,579 (Elapsed: 00:18:21) KL distance 8027.723633
2022-09-03 15:36:53,580 (Elapsed: 00:18:21) saving the model.
2022-09-03 15:36:54,273 (Elapsed: 00:18:21) epoch 2
2022-09-03 15:37:13,675 (Elapsed: 00:18:41) train 1599 9278.172852
2022-09-03 15:38:05,058 (Elapsed: 00:19:32) train 1699 9322.082031
2022-09-03 15:38:54,396 (Elapsed: 00:20:21) train 1799 9195.353516
2022-09-03 15:39:42,126 (Elapsed: 00:21:09) train 1899 9165.960938
2022-09-03 15:40:27,983 (Elapsed: 00:21:55) train 1999 9069.068359
2022-09-03 15:41:16,629 (Elapsed: 00:22:44) train 2099 8978.197266
2022-09-03 15:42:04,655 (Elapsed: 00:23:32) train 2199 8896.445312
2022-09-03 15:42:52,212 (Elapsed: 00:24:19) train 2299 8850.194336
2022-09-03 15:43:12,361 (Elapsed: 00:24:39) train_nelbo 8812.812500
2022-09-03 15:45:50,056 (Elapsed: 00:27:17) val, step: 156, NELBO: 100964.359375, neg Log p 100707.578125
2022-09-03 15:45:50,061 (Elapsed: 00:27:17) valid_nelbo 100964.359375
2022-09-03 15:45:50,062 (Elapsed: 00:27:17) valid neg log p 100707.578125
2022-09-03 15:45:50,062 (Elapsed: 00:27:17) valid bpd elbo 47.415619
2022-09-03 15:45:50,062 (Elapsed: 00:27:17) valid bpd log p 47.295029
2022-09-03 15:45:50,063 (Elapsed: 00:27:17) KL distance 9272.247070
2022-09-03 15:45:50,065 (Elapsed: 00:27:17) saving the model.
2022-09-03 15:45:50,781 (Elapsed: 00:27:18) epoch 3
2022-09-03 15:46:18,779 (Elapsed: 00:27:46) train 2399 8108.227051
2022-09-03 15:47:07,753 (Elapsed: 00:28:35) train 2499 8149.856934
2022-09-03 15:47:54,334 (Elapsed: 00:29:21) train 2599 8124.379395
2022-09-03 15:48:43,183 (Elapsed: 00:30:10) train 2699 8073.613770
2022-09-03 15:49:35,344 (Elapsed: 00:31:02) train 2799 8020.634766
2022-09-03 15:50:24,533 (Elapsed: 00:31:52) train 2899 7961.632812
2022-09-03 15:51:11,214 (Elapsed: 00:32:38) train 2999 7885.318848
2022-09-03 15:52:02,113 (Elapsed: 00:33:29) train 3099 7817.463867
2022-09-03 15:52:14,474 (Elapsed: 00:33:41) train_nelbo 7801.461914
2022-09-03 15:54:56,260 (Elapsed: 00:36:23) val, step: 156, NELBO: 111846.585938, neg Log p 111588.179688
2022-09-03 15:54:56,267 (Elapsed: 00:36:23) valid_nelbo 111846.585938
2022-09-03 15:54:56,268 (Elapsed: 00:36:23) valid neg log p 111588.179688
2022-09-03 15:54:56,268 (Elapsed: 00:36:23) valid bpd elbo 52.526211
2022-09-03 15:54:56,268 (Elapsed: 00:36:23) valid bpd log p 52.404854
2022-09-03 15:54:56,269 (Elapsed: 00:36:23) KL distance 10452.718750
2022-09-03 15:54:56,271 (Elapsed: 00:36:23) saving the model.
2022-09-03 15:54:56,900 (Elapsed: 00:36:24) epoch 4
2022-09-03 15:55:36,186 (Elapsed: 00:37:03) train 3199 7382.235352
2022-09-03 15:56:29,640 (Elapsed: 00:37:57) train 3299 7350.431152
2022-09-03 15:57:20,480 (Elapsed: 00:38:47) train 3399 7302.375488
2022-09-03 15:58:13,176 (Elapsed: 00:39:40) train 3499 7266.432129
2022-09-03 15:59:04,404 (Elapsed: 00:40:31) train 3599 7199.624023
2022-09-03 15:59:53,891 (Elapsed: 00:41:21) train 3699 7129.967285
2022-09-03 16:00:44,494 (Elapsed: 00:42:11) train 3799 7107.751465
2022-09-03 16:01:37,347 (Elapsed: 00:43:04) train 3899 7052.278809
2022-09-03 16:01:40,124 (Elapsed: 00:43:07) train_nelbo 7050.314941
2022-09-03 16:04:18,928 (Elapsed: 00:45:46) val, step: 156, NELBO: 106836.273438, neg Log p 106582.125000
2022-09-03 16:04:18,933 (Elapsed: 00:45:46) valid_nelbo 106836.273438
2022-09-03 16:04:18,934 (Elapsed: 00:45:46) valid neg log p 106582.125000
2022-09-03 16:04:18,934 (Elapsed: 00:45:46) valid bpd elbo 50.173229
2022-09-03 16:04:18,935 (Elapsed: 00:45:46) valid bpd log p 50.053875
2022-09-03 16:04:18,935 (Elapsed: 00:45:46) KL distance 9944.827148
2022-09-03 16:04:18,945 (Elapsed: 00:45:46) saving the model.
2022-09-03 16:04:19,626 (Elapsed: 00:45:47) epoch 5
2022-09-03 16:05:12,075 (Elapsed: 00:46:39) train 3999 7210.817383
2022-09-03 16:06:01,685 (Elapsed: 00:47:29) train 4099 6850.171875
2022-09-03 16:06:50,543 (Elapsed: 00:48:18) train 4199 6646.414551
2022-09-03 16:07:41,847 (Elapsed: 00:49:09) train 4299 6494.983398
2022-09-03 16:08:28,848 (Elapsed: 00:49:56) train 4399 6407.833984
2022-09-03 16:09:18,252 (Elapsed: 00:50:45) train 4499 6316.679688
2022-09-03 16:10:09,129 (Elapsed: 00:51:36) train 4599 6277.401855
2022-09-03 16:10:54,554 (Elapsed: 00:52:22) train_nelbo 6232.734375
2022-09-03 16:13:39,588 (Elapsed: 00:55:07) val, step: 156, NELBO: 119233.414062, neg Log p 118973.414062
2022-09-03 16:13:39,593 (Elapsed: 00:55:07) valid_nelbo 119233.414062
2022-09-03 16:13:39,594 (Elapsed: 00:55:07) valid neg log p 118973.414062
2022-09-03 16:13:39,594 (Elapsed: 00:55:07) valid bpd elbo 55.995266
2022-09-03 16:13:39,594 (Elapsed: 00:55:07) valid bpd log p 55.873161
2022-09-03 16:13:39,595 (Elapsed: 00:55:07) KL distance 11253.127930
2022-09-03 16:13:39,596 (Elapsed: 00:55:07) saving the model.
2022-09-03 16:13:40,202 (Elapsed: 00:55:07) epoch 6
2022-09-03 16:13:47,900 (Elapsed: 00:55:15) train 4699 6297.252441
2022-09-03 16:14:36,839 (Elapsed: 00:56:04) train 4799 5684.873047
2022-09-03 16:15:26,668 (Elapsed: 00:56:54) train 4899 5484.224609
2022-09-03 16:16:13,969 (Elapsed: 00:57:41) train 4999 5458.359375
2022-09-03 16:17:02,858 (Elapsed: 00:58:30) train 5099 5481.277832
2022-09-03 16:17:52,679 (Elapsed: 00:59:20) train 5199 5456.252441
2022-09-03 16:18:42,300 (Elapsed: 01:00:09) train 5299 5437.033203
2022-09-03 16:19:29,292 (Elapsed: 01:00:56) train 5399 5422.367676
2022-09-03 16:20:00,966 (Elapsed: 01:01:28) train_nelbo 5409.600586
2022-09-03 16:22:39,686 (Elapsed: 01:04:07) val, step: 156, NELBO: 128183.804688, neg Log p 127925.398438
2022-09-03 16:22:39,691 (Elapsed: 01:04:07) valid_nelbo 128183.804688
2022-09-03 16:22:39,692 (Elapsed: 01:04:07) valid neg log p 127925.398438
2022-09-03 16:22:39,692 (Elapsed: 01:04:07) valid bpd elbo 60.198612
2022-09-03 16:22:39,692 (Elapsed: 01:04:07) valid bpd log p 60.077259
2022-09-03 16:22:39,693 (Elapsed: 01:04:07) KL distance 12210.181641
2022-09-03 16:22:39,695 (Elapsed: 01:04:07) saving the model.
2022-09-03 16:22:40,500 (Elapsed: 01:04:08) epoch 7
2022-09-03 16:22:56,670 (Elapsed: 01:04:24) train 5499 4848.731445
2022-09-03 16:23:47,096 (Elapsed: 01:05:14) train 5599 4718.274902
2022-09-03 16:24:38,107 (Elapsed: 01:06:05) train 5699 4558.673828
2022-09-03 16:25:25,587 (Elapsed: 01:06:53) train 5799 4469.064453
2022-09-03 16:26:12,987 (Elapsed: 01:07:40) train 5899 4448.728516
2022-09-03 16:27:01,048 (Elapsed: 01:08:28) train 5999 4433.965332
2022-09-03 16:27:47,427 (Elapsed: 01:09:14) train 6099 4412.225098
2022-09-03 16:28:34,472 (Elapsed: 01:10:01) train 6199 4385.167480
2022-09-03 16:28:58,395 (Elapsed: 01:10:25) train_nelbo 4365.362305
2022-09-03 16:31:35,633 (Elapsed: 01:13:03) val, step: 156, NELBO: 142238.562500, neg Log p 141973.062500
2022-09-03 16:31:35,640 (Elapsed: 01:13:03) valid_nelbo 142238.562500
2022-09-03 16:31:35,641 (Elapsed: 01:13:03) valid neg log p 141973.062500
2022-09-03 16:31:35,642 (Elapsed: 01:13:03) valid bpd elbo 66.799110
2022-09-03 16:31:35,642 (Elapsed: 01:13:03) valid bpd log p 66.674423
2022-09-03 16:31:35,643 (Elapsed: 01:13:03) KL distance 13886.012695
2022-09-03 16:31:35,645 (Elapsed: 01:13:03) saving the model.
2022-09-03 16:31:36,460 (Elapsed: 01:13:03) epoch 8
2022-09-03 16:32:02,171 (Elapsed: 01:13:29) train 6299 3420.562012
2022-09-03 16:32:51,449 (Elapsed: 01:14:18) train 6399 3343.415771
2022-09-03 16:33:41,770 (Elapsed: 01:15:09) train 6499 3334.759766
2022-09-03 16:34:30,851 (Elapsed: 01:15:58) train 6599 3313.350342
2022-09-03 16:35:22,457 (Elapsed: 01:16:49) train 6699 3267.575195
2022-09-03 16:36:12,176 (Elapsed: 01:17:39) train 6799 3250.286621
2022-09-03 16:36:59,704 (Elapsed: 01:18:27) train 6899 3235.259521
2022-09-03 16:37:45,624 (Elapsed: 01:19:13) train 6999 3217.004639
2022-09-03 16:38:00,774 (Elapsed: 01:19:28) train_nelbo 3214.628418
2022-09-03 16:40:40,163 (Elapsed: 01:22:07) val, step: 156, NELBO: 164701.109375, neg Log p 164422.031250
2022-09-03 16:40:40,171 (Elapsed: 01:22:07) valid_nelbo 164701.109375
2022-09-03 16:40:40,171 (Elapsed: 01:22:07) valid neg log p 164422.031250
2022-09-03 16:40:40,172 (Elapsed: 01:22:07) valid bpd elbo 77.348137
2022-09-03 16:40:40,172 (Elapsed: 01:22:07) valid bpd log p 77.217072
2022-09-03 16:40:40,173 (Elapsed: 01:22:07) KL distance 16324.376953
2022-09-03 16:40:40,175 (Elapsed: 01:22:07) saving the model.
2022-09-03 16:40:40,874 (Elapsed: 01:22:08) epoch 9
2022-09-03 16:41:17,787 (Elapsed: 01:22:45) train 7099 2653.535645
2022-09-03 16:42:06,672 (Elapsed: 01:23:34) train 7199 2638.142090
2022-09-03 16:42:56,522 (Elapsed: 01:24:24) train 7299 2625.502686
2022-09-03 16:43:43,005 (Elapsed: 01:25:10) train 7399 2607.634521
2022-09-03 16:44:30,868 (Elapsed: 01:25:58) train 7499 2603.764648
2022-09-03 16:45:21,771 (Elapsed: 01:26:49) train 7599 2603.711914
2022-09-03 16:46:08,426 (Elapsed: 01:27:35) train 7699 2599.888672
2022-09-03 16:46:58,325 (Elapsed: 01:28:25) train 7799 2592.855957
2022-09-03 16:47:04,185 (Elapsed: 01:28:31) train_nelbo 2592.509277
2022-09-03 16:49:43,852 (Elapsed: 01:31:11) val, step: 156, NELBO: 175353.015625, neg Log p 175063.390625
2022-09-03 16:49:43,858 (Elapsed: 01:31:11) valid_nelbo 175353.015625
2022-09-03 16:49:43,858 (Elapsed: 01:31:11) valid neg log p 175063.390625
2022-09-03 16:49:43,858 (Elapsed: 01:31:11) valid bpd elbo 82.350563
2022-09-03 16:49:43,859 (Elapsed: 01:31:11) valid bpd log p 82.214546
2022-09-03 16:49:43,859 (Elapsed: 01:31:11) KL distance 17521.693359
2022-09-03 16:49:43,861 (Elapsed: 01:31:11) saving the model.
2022-09-03 21:12:23,498 (Elapsed: 05:53:51) val, step: 156, NELBO: 175352.968750, neg Log p 174746.843750
2022-09-03 21:12:23,502 (Elapsed: 05:53:51) final valid nelbo 175352.968750
2022-09-03 21:12:23,502 (Elapsed: 05:53:51) final valid neg log p 174746.843750
